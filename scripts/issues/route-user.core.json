{
  "title": "[HIGH] [RouteContext] Migrate routes/user/core.py (10 functions)",
  "body": "## Objective\nMigrate `src/domolibrary2/routes/user/core.py` to use the RouteContext pattern.\n\n## Reference Implementation\nSee `src/domolibrary2/routes/appdb/collections.py` for the canonical example.\n\n## Tasks\n- [ ] Add `RouteContext` import: `from ...client.context import RouteContext`\n- [ ] Update all 10 `@gd.route_function` decorated functions to accept `context` parameter\n- [ ] Add context normalization inside each function\n- [ ] Update `get_data()` calls to use `context=context`\n- [ ] Verify all tests pass\n- [ ] Update `TO_DOS/routes/user.core.md` to mark functions as complete\n\n## Migration Pattern\n\nEach function should follow this pattern:\n\n```python\n@gd.route_function\nasync def function_name(\n    auth: DomoAuth,\n    required_param: str,\n    *,  # Make following params keyword-only\n    context: RouteContext | None = None,\n    session: httpx.AsyncClient | None = None,\n    debug_api: bool = False,\n    debug_num_stacks_to_drop: int = 1,\n    parent_class: Optional[str] = None,\n    return_raw: bool = False,\n) -> rgd.ResponseGetData:\n    \"\"\"Docstring here.\"\"\"\n    if context is None:\n        context = RouteContext(\n            session=session,\n            debug_api=debug_api,\n            debug_num_stacks_to_drop=debug_num_stacks_to_drop,\n            parent_class=parent_class,\n        )\n\n    url = f\"https://{auth.domo_instance}.domo.com/api/...\"\n\n    res = await gd.get_data(\n        auth=auth,\n        method=\"GET\",\n        url=url,\n        context=context,  # Use context instead of individual params\n    )\n\n    if not res.is_success:\n        raise SomeError(res=res)\n\n    return res\n```\n\n## Functions to Update\n- [ ] `get_all_users` (line 82)\n- [ ] `search_users` (line 143)\n- [ ] `search_users_by_id` (line 231)\n- [ ] `search_users_by_email` (line 322)\n- [ ] `_get_by_id` (line 412)\n- [ ] `get_by_id` (line 512)\n- [ ] `search_virtual_user_by_subscriber_instance` (line 578)\n- [ ] `create_user` (line 642)\n- [ ] `delete_user` (line 719)\n- [ ] `toggle_is_enable_user_direct_signon` (line 770)\n\n## Success Criteria\n- All functions accept optional `context` parameter\n- All functions normalize context if not provided\n- All `get_data()` calls use context\n- Existing tests pass without modification\n- No breaking changes (legacy parameters still work via decorator)\n\n## Related Files\n- TODO: `external/dl-remuxed/TO_DOS/routes/user.core.md`\n- Implementation Plan: `external/dl-remuxed/code_review/route-context-implementation-plan.md`\n",
  "labels": [
    "route-context-migration",
    "refactor",
    "priority-high"
  ]
}
